# 今日のプロセスマネージャごっこまとめ

---

## ✅ 実践した内容

### 1. 親プロセスのデーモン化
- `fork()` → 親を即終了
- `setsid()` → 新しいセッションを作って端末・親から完全に切り離し
- 2回目の `fork()` → セッションリーダーをさらに捨てる
- `stdin`, `stdout`, `stderr` を `/dev/null` に切り替える

### 2. デーモンが生きてることを確認する方法
- `ps -ef | grep my_daemon`
- `htop` で PID を確認
- `tail -f /tmp/my_daemon_heartbeat.log` で heartbeat ログを確認

### 3. `&` とデーモンの違い

| 方法    | 親プロセス      | ターミナル閉じたら | 出力          | 実行の責任       |
|---------|----------------|------------------|--------------|----------------|
| `&`     | シェル (bash)   | 死ぬ (`SIGHUP`)  | ターミナル     | シェルにぶら下がる |
| デーモン | なし (孤立)     | 死なない           | `/dev/null`   | OS上で自立       |

- `&` はシェルの機能、ターミナルと繋がったまま
- デーモンはプロセス自体が OS 上で完全孤立して動く

### 4. セッションとは？
- 端末とそれに属するプロセスたちのまとまり
- `setsid()` で新しいセッションを作ることで、ターミナルから完全に切り離し可能
- Macでは `ps -o pid,sid,pgid,tty,command -p <PID>` で確認できる

---

## ✅ 今日のハイライト
- `setsid()` が「ターミナルからの完全独立」のキモだった
- デーモンは「孤高の存在」、親もターミナルも無し
- `&` はあくまで「親の見える範囲の裏方」
- Mac でもセッションIDは `ps` で確認可能
- `tail -f` で「生きてる感」を爆上げした

